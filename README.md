# ComfyUI Multi-View 3D Preview Plugin

一个强大的 ComfyUI 插件,可以将多张不同角度的图片转换成可交互的 3D/全景预览。

## 功能特性

### 3D预览功能

- ✨ 支持 5-8 张不同角度的图片输入
- 🎨 三种预览模式:
  - **Carousel (环形)**: 图片围成一圈排列
  - **Sphere (球形)**: 图片在球面上分布
  - **Cube (立方体)**: 图片按立方体六面排列
- 🖱️ 鼠标拖拽旋转视图
- 🔄 自动旋转功能
- 💾 导出为独立的 HTML 文件
- 🌐 直接在浏览器中预览

### 文本列表功能

- 📝 创建文本列表 (最多8项)
- 🔗 合并多个列表 (最多5个列表)
- 👁️ 格式化显示列表内容
- 🌏 完整支持中文和特殊字符
- 🔄 支持JSON和逗号分隔格式
- 🎯 适用于提示词管理、批量处理等场景

## 安装方法

1. 将此文件夹复制到 ComfyUI 的 `custom_nodes` 目录下:
   ```bash
   cd ComfyUI/custom_nodes
   git clone <your-repo-url> comfyui_edit23D
   ```

2. 重启 ComfyUI

3. 插件会自动加载,无需额外依赖

## 使用方法

### 3D预览节点使用

1. **添加节点**: 在节点菜单中找到 `image/3D` 分类

2. **多视角图片输入节点** (`MultiViewImageInput`):
   - 可以连接 1-8 张图片
   - 将多张图片组合成一个多视角数据

3. **3D预览节点** (`MultiView3DPreview`):
   - 连接多视角图片数据
   - 选择预览模式 (carousel/sphere/cube)
   - 调整旋转速度 (0.1-5.0)
   - 开启/关闭自动旋转
   - 直接在 ComfyUI 界面中预览 3D 效果

4. **保存3D预览HTML节点** (`SaveMultiView3D`):
   - 将 3D 预览导出为独立的 HTML 文件
   - 可以在任何浏览器中打开
   - 支持所有交互功能

### 文本列表节点使用

1. **添加节点**: 在节点菜单中找到 `utils/text` 分类

2. **创建文本列表节点** (`TextListCreate`):
   - 输入最多8个文本项
   - 输出JSON格式的列表

3. **文本列表合并节点** (`TextListMerge`):
   - 连接最多5个列表输入
   - 支持JSON格式和逗号分隔格式
   - 输出合并后的列表

4. **显示文本列表节点** (`TextListDisplay`):
   - 格式化显示列表内容
   - 便于查看合并结果

### 工作流示例

#### 3D预览工作流

```
[加载图片1] ──┐
[加载图片2] ──┤
[加载图片3] ──┼──> [多视角图片输入] ──> [3D预览]
[加载图片4] ──┤                      └──> [保存3D预览HTML]
[加载图片5] ──┘
```

#### 文本列表合并工作流

```
[创建列表1: "1","2","3"] ──┐
                           ├──> [文本列表合并] ──> [显示列表]
[创建列表2: "4","5","6"] ──┘

结果: ["1", "2", "3", "4", "5", "6"]
```

## 预览模式说明

### Carousel (环形模式)
- 适合: 360度环绕拍摄的物体
- 效果: 图片围成一圈,像旋转木马一样排列
- 推荐图片数: 6-8张

### Sphere (球形模式)
- 适合: 全方位多角度拍摄
- 效果: 图片在球面上均匀分布
- 推荐图片数: 5-8张

### Cube (立方体模式)
- 适合: 六个主要方向的拍摄
- 效果: 前后左右上下六个面
- 推荐图片数: 6张

## 控制说明

- **鼠标拖拽**: 旋转视图
- **自动旋转**: 可以在节点参数中开启/关闭
- **旋转速度**: 可调节自动旋转的速度

## 导出的 HTML 文件

导出的 HTML 文件包含:
- 完整的 3D 渲染引擎 (Three.js)
- 所有图片资源
- 交互控制界面
- 可以独立运行,无需服务器

## 技术栈

- **后端**: Python + PyTorch
- **前端**: Three.js (WebGL 3D渲染)
- **图片处理**: PIL/Pillow + NumPy

## 常见问题

**Q: 图片数量必须是固定的吗?**
A: 不是,支持 1-8 张图片,但建议至少 5 张以获得更好的 3D 效果。

**Q: 支持什么格式的图片?**
A: 支持 ComfyUI 的标准图片格式 (PNG, JPG 等)。

**Q: 可以调整图片的排列位置吗?**
A: 目前图片位置由预览模式自动决定,未来版本会支持自定义位置。

**Q: 导出的 HTML 文件可以在移动设备上查看吗?**
A: 可以,支持触摸手势进行旋转操作。

## 许可证

MIT License

## 更新日志

### v1.0.0 (2026-01-12)
- 初始版本发布
- 支持三种预览模式
- 支持导出 HTML 文件
- 支持 ComfyUI 界面内预览

## 贡献

欢迎提交 Issue 和 Pull Request!

## 联系方式

如有问题或建议,请在 GitHub 上提 Issue。
